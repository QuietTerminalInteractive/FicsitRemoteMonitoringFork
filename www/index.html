<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/porisius/FicsitRemoteMonitoring/main/Resources/Icon128.png">
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
      integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
      crossorigin=""
    />

    <script
      src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
      integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
      crossorigin=""
    ></script>
    <script src="js/leaflet.measure.js"></script>
    <script src="js/leaflet-color-markers.js"></script>
    <script src="js/easy-button.js"></script>
    <script src="js/index.js"></script>

    <link rel="stylesheet" type="text/css" href="/css/style.css" />

    <title>Ficsit Remote Monitoring</title>
  </head>

  <body class="bg">
    <div id="menu" style="height: auto; width: 100%">
      <center style="display: flex">
        <button onclick="menuShow('map')" class="button">Map</button>
        <button onclick="menuShow('PowerTable')" class="button">Power</button>
        <button onclick="menuShow('DroneTable')" class="button">Drone</button>
        <button onclick="menuShow('ProductionTable')" class="button">
          Overall Production
        </button>
        <button onclick="menuShow('FactoryTable')" class="button">
          Detailed Production
        </button>
        <button onclick="menuShow('About')" class="button">About</button>
        <button onclick="menuShow('Theme')" class="button">Theme</button>
      </center>

      <div id="map"></div>
      <div id="About">
        <h1>About</h1>
        <div>
          <div class="text">
            This mod is a remote monitoring tool for your factory.
          </div>
          <div class="text">
            It shows your factory's current production, power usage and drone
            status.
          </div>
          <a style="width: auto;"
            class="button text"
            href="https://docs.ficsit.app/ficsitremotemonitoring/latest/index.html"
            >Documentation</a
          >
		  <a style="width: auto;"
            class="button text"
            href="https://github.com/porisius/FicsitRemoteMonitoring"
            >Github</a
          >
        </div>
      </div>

      <div id="Theme">
        <div class="colorSettings">
          <div class="colorPicker">
            <div class="colorPickerText">Main Color</div>
            <input
              class="cPicker"
              type="color"
              id="mainColor"
              name="mainColor"
              value="#000000"
            />
          </div>
          <div class="colorPicker">
            <div class="colorPickerText">Second Color</div>
            <input
              class="cPicker"
              type="color"
              id="secondColor"
              name="secondColor"
              value="#000000"
            />
          </div>
          <div class="colorPicker">
            <div class="colorPickerText">Text Color</div>
            <input
              class="cPicker"
              type="color"
              id="textColor"
              name="textColor"
              value="#000000"
            />
          </div>
          <div class="colorPicker">
            <div class="colorPickerText">Table Color</div>
            <input
              class="cPicker"
              type="color"
              id="tableColor"
              name="tableColor"
              value="#000000"
            />
          </div>
          <div class="colorPicker">
            <div class="colorPickerText">Background Color</div>
            <input
              class="cPicker"
              type="color"
              id="bgColor"
              name="bgColor"
              value="#000000"
            />
          </div>

          <button onclick="defaultColors()" class="cButton button">
            Reset Colors
          </button>
        </div>
        <script>
          var mainColor = document.getElementById("mainColor");
          var secondColor = document.getElementById("secondColor");
          var textColor = document.getElementById("textColor");
          var tableColor = document.getElementById("tableColor");
          var bgColor = document.getElementById("bgColor");

          mainColor.addEventListener("input", updateFirst, false);
          secondColor.addEventListener("input", updateSecond, false);
          textColor.addEventListener("input", updateText, false);
          tableColor.addEventListener("input", updateTable, false);
          bgColor.addEventListener("input", updateBg, false);

          mainColor.addEventListener("change", updateFirst, false);
          secondColor.addEventListener("change", updateSecond, false);
          textColor.addEventListener("change", updateText, false);
          tableColor.addEventListener("change", updateTable, false);
          bgColor.addEventListener("change", updateBg, false);

          loadStorage();
        </script>
      </div>
    </div>
    <script src="js/map.js"></script>

    <div style="margin:10px;"">
      <div id="PowerTable"></div>
      <div id="DroneTable"></div>
      <div id="ProductionTable"></div>
      <div id="FactoryTable"></div>

      <script src="js/getPower.js"></script>
      <script src="js/getDrone.js"></script>
      <script src="js/getProdStats.js"></script>
      <script src="js/getFactory.js"></script>
    </div>

    <script>
      menuShow("map");
    </script>
  </body>

  <script>
    // for testing or if the data is failed to get.
    const test_Drone = JSON.parse(
      '[{"HomeStation": "Station 1", "PairedStation": "Station 2", "DroneStatus": "Idle", "AvgTotalIncRate": "0.00", "AvgTotalOutRate": "0.00", "EstBatteryRate": "0.00"}]'
    );
    const test_Factory = JSON.parse(
      '[{"building":"Constructor","location":{"x":-38767.902344,"y":251462.84375,"z":-2902.275635,"rotation":90},"Recipe":"Iron Plate","production":[{"Name":"Iron Plate","CurrentProd":29.799999,"MaxProd":30,"ProdPercent":"99.199997"}],"ingredients":[{"Name":"Iron Ingot","CurrentConsumed":44.599998,"MaxConsumed":45,"ConsPercent":"99.199997"}],"ManuSpeed":1,"IsConfigured":true,"IsProducing":true,"IsPaused":false,"CircuitID":14}]'
    );
    const test_Power = JSON.parse(
      '[{"CircuitID":14, "PowerCapacity":1392.0, "PowerProduction":756.0, "PowerConsumed":756.0, "PowerMaxConsumed":2443.0, "BatteryDifferential":0.0, "BatteryPercent":49.650002, "BatteryCapacity":500, "BatteryTimeEmpty":"00:00:00", "BatteryTimeFull":"00:00:00", "FuseTriggered":false}]'
    );
    const test_ProdStats = JSON.parse(
      '[{"ItemName":"Automated Wiring","ProdPerMin":"P: 0.0/0.1/min - C: 0.0/0.0/min","ProdPercent":0.3,"ConsPercent":0,"CurrentProd":0,"MaxProd":0.1,"CurrentConsumed":0,"MaxConsumed":0,"Type":"Belt"},{"ItemName":"Biomass","ProdPerMin":"P: 0.0/0.0/min - C: 0.0/113.0/min","ProdPercent":0,"ConsPercent":0,"CurrentProd":0,"MaxProd":0,"CurrentConsumed":0,"MaxConsumed":1.1,"Type":"Belt"},{"ItemName":"Cable","ProdPerMin":"P: 0.4/1.1/min - C: 41.0/125.0/min","ProdPercent":0.4,"ConsPercent":0.3,"CurrentProd":0.4,"MaxProd":1.1,"CurrentConsumed":0.4,"MaxConsumed":1.3,"Type":"Belt"},{"ItemName":"Caterium Ingot","ProdPerMin":"P: 0.0/0.3/min - C: 0.0/36.0/min","ProdPercent":0,"ConsPercent":0,"CurrentProd":0,"MaxProd":0.3,"CurrentConsumed":0,"MaxConsumed":0.4,"Type":"Belt"},{"ItemName":"Caterium Ore","ProdPerMin":"P: 0.0/0.0/min - C: 0.0/90.0/min","ProdPercent":0,"ConsPercent":0,"CurrentProd":0,"MaxProd":0,"CurrentConsumed":0,"MaxConsumed":0.9,"Type":"Belt"},{"ItemName":"Coal","ProdPerMin":"P: 0.0/0.0/min - C: 178.0/700.0/min","ProdPercent":0,"ConsPercent":0.3,"CurrentProd":0,"MaxProd":0,"CurrentConsumed":1.8,"MaxConsumed":7,"Type":"Belt"},{"ItemName":"Compacted Coal","ProdPerMin":"P: 0.6/2.5/min - C: 82.0/50.0/min","ProdPercent":0.2,"ConsPercent":1.6,"CurrentProd":0.6,"MaxProd":2.5,"CurrentConsumed":0.8,"MaxConsumed":0.5,"Type":"Belt"},{"ItemName":"Concrete","ProdPerMin":"P: 0.1/0.4/min - C: 0.0/30.0/min","ProdPercent":0.3,"ConsPercent":0,"CurrentProd":0.1,"MaxProd":0.4,"CurrentConsumed":0,"MaxConsumed":0.3,"Type":"Belt"},{"ItemName":"Copper Ingot","ProdPerMin":"P: 1.1/2.0/min - C: 75.0/158.0/min","ProdPercent":0.6,"ConsPercent":0.5,"CurrentProd":1.1,"MaxProd":2,"CurrentConsumed":0.8,"MaxConsumed":1.6,"Type":"Belt"},{"ItemName":"Copper Ore","ProdPerMin":"P: 0.4/0.4/min - C: 112.0/195.0/min","ProdPercent":1,"ConsPercent":0.6,"CurrentProd":0.4,"MaxProd":0.4,"CurrentConsumed":1.1,"MaxConsumed":2,"Type":"Belt"},{"ItemName":"Copper Sheet","ProdPerMin":"P: 0.0/0.2/min - C: 0.0/0.0/min","ProdPercent":0,"ConsPercent":0,"CurrentProd":0,"MaxProd":0.2,"CurrentConsumed":0,"MaxConsumed":0,"Type":"Belt"},{"ItemName":"Encased Industrial Beam","ProdPerMin":"P: 0.0/0.1/min - C: 0.0/0.0/min","ProdPercent":0,"ConsPercent":0,"CurrentProd":0,"MaxProd":0.1,"CurrentConsumed":0,"MaxConsumed":0,"Type":"Belt"},{"ItemName":"Fabric","ProdPerMin":"P: 0.0/0.2/min - C: 0.0/0.0/min","ProdPercent":0,"ConsPercent":0,"CurrentProd":0,"MaxProd":0.2,"CurrentConsumed":0,"MaxConsumed":0,"Type":"Belt"},{"ItemName":"Iron Ingot","ProdPerMin":"P: 1.2/4.2/min - C: 91.0/285.0/min","ProdPercent":0.3,"ConsPercent":0.3,"CurrentProd":1.2,"MaxProd":4.2,"CurrentConsumed":0.9,"MaxConsumed":2.9,"Type":"Belt"},{"ItemName":"Iron Ore","ProdPerMin":"P: 2.4/2.4/min - C: 237.0/870.0/min","ProdPercent":1,"ConsPercent":0.3,"CurrentProd":2.4,"MaxProd":2.4,"CurrentConsumed":2.4,"MaxConsumed":8.7,"Type":"Belt"},{"ItemName":"Iron Plate","ProdPerMin":"P: 0.2/0.8/min - C: 19.0/210.0/min","ProdPercent":0.2,"ConsPercent":0.1,"CurrentProd":0.2,"MaxProd":0.8,"CurrentConsumed":0.2,"MaxConsumed":2.1,"Type":"Belt"},{"ItemName":"Iron Rod","ProdPerMin":"P: 0.6/1.7/min - C: 53.0/190.0/min","ProdPercent":0.4,"ConsPercent":0.3,"CurrentProd":0.6,"MaxProd":1.7,"CurrentConsumed":0.5,"MaxConsumed":1.9,"Type":"Belt"},{"ItemName":"Limestone","ProdPerMin":"P: 0.3/0.3/min - C: 29.0/113.0/min","ProdPercent":1,"ConsPercent":0.3,"CurrentProd":0.3,"MaxProd":0.3,"CurrentConsumed":0.3,"MaxConsumed":1.1,"Type":"Belt"},{"ItemName":"Modular Frame","ProdPerMin":"P: 0.0/0.1/min - C: 2.0/6.0/min","ProdPercent":0.5,"ConsPercent":0.4,"CurrentProd":0,"MaxProd":0.1,"CurrentConsumed":0,"MaxConsumed":0.1,"Type":"Belt"},{"ItemName":"Mycelia","ProdPerMin":"P: 0.0/0.0/min - C: 0.0/23.0/min","ProdPercent":0,"ConsPercent":0,"CurrentProd":0,"MaxProd":0,"CurrentConsumed":0,"MaxConsumed":0.2,"Type":"Belt"},{"ItemName":"Quickwire","ProdPerMin":"P: 0.0/1.8/min - C: 0.0/0.0/min","ProdPercent":0,"ConsPercent":0,"CurrentProd":0,"MaxProd":1.8,"CurrentConsumed":0,"MaxConsumed":0,"Type":"Belt"},{"ItemName":"Reinforced Iron Plate","ProdPerMin":"P: 0.0/0.4/min - C: 3.0/13.0/min","ProdPercent":0.1,"ConsPercent":0.3,"CurrentProd":0,"MaxProd":0.4,"CurrentConsumed":0,"MaxConsumed":0.1,"Type":"Belt"},{"ItemName":"Rotor","ProdPerMin":"P: 0.0/0.1/min - C: 0.0/5.0/min","ProdPercent":0,"ConsPercent":0,"CurrentProd":0,"MaxProd":0.1,"CurrentConsumed":0,"MaxConsumed":0.1,"Type":"Belt"},{"ItemName":"Screw","ProdPerMin":"P: 1.6/3.6/min - C: 39.0/840.0/min","ProdPercent":0.4,"ConsPercent":0,"CurrentProd":1.6,"MaxProd":3.6,"CurrentConsumed":0.4,"MaxConsumed":8.4,"Type":"Belt"},{"ItemName":"Smart Plating","ProdPerMin":"P: 0.0/0.1/min - C: 0.0/0.0/min","ProdPercent":0,"ConsPercent":0,"CurrentProd":0,"MaxProd":0.1,"CurrentConsumed":0,"MaxConsumed":0,"Type":"Belt"},{"ItemName":"Solid Biofuel","ProdPerMin":"P: 0.0/0.0/min - C: 128.0/56.0/min","ProdPercent":0,"ConsPercent":2.3,"CurrentProd":0,"MaxProd":0,"CurrentConsumed":1.3,"MaxConsumed":0.6,"Type":"Belt"},{"ItemName":"Stator","ProdPerMin":"P: 0.0/0.1/min - C: 2.0/6.0/min","ProdPercent":0.1,"ConsPercent":0.3,"CurrentProd":0,"MaxProd":0.1,"CurrentConsumed":0,"MaxConsumed":0.1,"Type":"Belt"},{"ItemName":"Steel Beam","ProdPerMin":"P: 0.3/0.9/min - C: 29.0/99.0/min","ProdPercent":0.3,"ConsPercent":0.3,"CurrentProd":0.3,"MaxProd":0.9,"CurrentConsumed":0.3,"MaxConsumed":1,"Type":"Belt"},{"ItemName":"Steel Ingot","ProdPerMin":"P: 1.2/4.5/min - C: 117.0/465.0/min","ProdPercent":0.3,"ConsPercent":0.3,"CurrentProd":1.2,"MaxProd":4.5,"CurrentConsumed":1.2,"MaxConsumed":4.7,"Type":"Belt"},{"ItemName":"Steel Pipe","ProdPerMin":"P: 0.0/0.7/min - C: 5.0/38.0/min","ProdPercent":0.1,"ConsPercent":0.1,"CurrentProd":0,"MaxProd":0.7,"CurrentConsumed":0.1,"MaxConsumed":0.4,"Type":"Belt"},{"ItemName":"Sulfur","ProdPerMin":"P: 0.6/0.6/min - C: 60.0/250.0/min","ProdPercent":1,"ConsPercent":0.2,"CurrentProd":0.6,"MaxProd":0.6,"CurrentConsumed":0.6,"MaxConsumed":2.5,"Type":"Belt"},{"ItemName":"Versatile Framework","ProdPerMin":"P: 0.0/0.1/min - C: 0.0/0.0/min","ProdPercent":0.4,"ConsPercent":0,"CurrentProd":0,"MaxProd":0.1,"CurrentConsumed":0,"MaxConsumed":0,"Type":"Belt"},{"ItemName":"Water","ProdPerMin":"P:297.600006/min - C: 453.200012/min","ProdPercent":1,"ConsPercent":1,"CurrentProd":2976.5,"MaxProd":2976.5,"CurrentConsumed":4531.799805,"MaxConsumed":4531.799805,"Type":"Pipe"},{"ItemName":"Wire","ProdPerMin":"P: 1.5/2.6/min - C: 89.0/310.0/min","ProdPercent":0.6,"ConsPercent":0.3,"CurrentProd":1.5,"MaxProd":2.6,"CurrentConsumed":0.9,"MaxConsumed":3.1,"Type":"Belt"}]'
    );
  </script>
</html>
